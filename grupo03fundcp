#3Av Fund CP - Grupo 03
#importa pacotes
import pandas as pd
from babel.numbers import format_currency
import sys
from tabulate import tabulate

#carrega arquivo e define exibiçao tabela
tabela = pd.read_csv(r'/2019-gastos-deputados.csv', sep = (';'))
pd.set_option('display.max_columns', None)

#formata valores como monetarios
tabela['vlrDocumento'] = tabela['vlrDocumento'].apply(lambda x: format_currency(x, currency="BRL", locale="pt_BR"))
tabela['vlrGlosa'] = tabela['vlrGlosa'].apply(lambda x: format_currency(x, currency="BRL", locale="pt_BR"))
tabela['vlrLiquido'] = tabela['vlrLiquido'].apply(lambda x: format_currency(x, currency="BRL", locale="pt_BR"))

#renomeia colunas
tabela.rename(columns = {'txNomeParlamentar': 'Nome do Parlamentar', 'ideCadastro': 'N° de Cadastro','nuCarteiraParlamentar': 'Carteira Parlamentar', 'nuLegislatura': 'Ano Legislatura', 'sgUF': 'UF', 'sgPartido': 'Partido', 'codLegislatura': 'Cód. Legislatura', 'numSubCota': 'N° Cota', 'txtDescricao': 'Descrição', 'numEspecificacaoSubCota': 'N° Espec. Cota', 'numMes': 'Mês', 'numAno': 'Ano', 'numParcela': 'N° Parcela', 'numLote': 'Lote', 'nuDeputadoId': 'ID Deputado', 'ideDocumento': 'Documento', 'datEmissao': 'Emissão', 'vlrDocumento': 'Valor do Documento'}, inplace = True)

#menu de opçoes
def menu():
    opt_menu = {
    0: 'Verificar ausência de valores.',
    1: 'Exibir amostra',
    2: '...',
    3: 'Sair',
    }
    for key in opt_menu.keys():
        print ('[', key, ']', ' ', opt_menu[key] )

#testa variavel name executa apenas se for main (util em codigos com varios modulos)
if __name__=='__main__':
    while (True):
        menu()
        opt=''
        try:
            opt = int(input('Selecione uma opção: ')) 
        except:
            print('entrada inválida, insira um numero...')
        if opt == 0:
            tabelaaux = tabela[tabela.isnull().any(axis=1)]
            print(tabulate(tabelaaux.head(10), headers = 'keys', tablefmt = 'github'))
        elif opt == 1:
            print(tabulate(tabela.head(), headers = 'keys', tablefmt = 'github'))
        elif opt == 3:
            sys.exit()
            break     
        else:
            print('opção invalida')
    pass

"""
Tarefas do projeto:

Instalar e importar a API Pandas; ok

Carregar a base de dados (arquivo na extensão .csv) pela API Pandas; ok

Apresentar apenas as 5 primeiras linhas de informações da base de dados; ok

Nomear adequadamente as colunas via API Pandas; ok

Verificar a ausência de valores na base de dados; ok

Inserir valores adequados na ausência de valores na base de dados;

Desenvolver um menu (console) para acessar as principais funcionalidades do aplicativo (não há necessidade de desenvolver interface gráfica); ok

Desenvolver recursos adicionais conforme a necessidade de cada base de dados. ok
"""
